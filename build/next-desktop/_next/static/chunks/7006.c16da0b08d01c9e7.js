(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7006],{78276:function(t,e,r){var s={"./default.ts":[33551,3551],"./development.ts":[10889,7738,889],"./getConfig.ts":[31450],"./getMetrikaSettings.ts":[20162,162],"./getPrefixUrl.ts":[30518,8987],"./production.ts":[66228,7738,6228],"./qa.ts":[51155,7738,1918],"./retryPolicyConfigs/musicExternalApiRetryPolicyConfig.ts":[88979,8979],"./types/ConfigVariables.ts":[64580,4580],"./types/ConfigVariablesPlayer.ts":[62981,2981],"./types/ConfigVariablesResource.ts":[72119,2119]};function o(t){if(!r.o(s,t))return Promise.resolve().then(function(){var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e});var e=s[t],o=e[0];return Promise.all(e.slice(1).map(r.e)).then(function(){return r(o)})}o.keys=function(){return Object.keys(s)},o.id=78276,t.exports=o},80930:function(t,e,r){"use strict";r.d(e,{$:function(){return h}});var s,o,n=r(28307),i=r(93991);(s=o||(o={})).WEB="YandexMusicWebNext",s.DESKTOP="YandexMusicDesktopApp";let a=(t,e)=>"".concat(t,"/").concat(e),h=()=>{{let t="".concat(o.DESKTOP).concat((0,i.y)((0,n.X)()));return a(t,"1.0")}}},98782:function(t,e,r){"use strict";r.d(e,{SD:function(){return u},TO:function(){return p}});var s,o,n=r(24807),i=r(63198),a=r(55712);class h{setRedirectUrl(t){let{pathname:e,host:r,searchParams:s,tld:o}=t;this.host=null!=r?r:this.host,this.tld=null!=o?o:this.tld,this.searchParams=null!=s?s:this.searchParams,this.pathname=null!=e?e:this.pathname}get passportLogin(){}constructor(t,e){(0,n._)(this,"storage",void 0),(0,n._)(this,"config",void 0),(0,n._)(this,"pathname",void 0),(0,n._)(this,"searchParams",void 0),(0,n._)(this,"host",void 0),(0,n._)(this,"tld",void 0),this.storage=t,this.config=e,this.pathname="",this.searchParams="",this.host="",this.tld=""}}class c extends h{getRedirectUri(){let t="".concat(this.pathname).concat(this.searchParams?"?".concat(this.searchParams):"");return encodeURIComponent("https://".concat(this.host).concat(t))}get authorizationUrl(){if(!this.host||!this.tld)return;let{passportCredentials:{host:t,origin:e}}=this.config,r=(0,a.v)(t,this.tld),s=this.getRedirectUri();return"".concat(r,"/auth?origin=").concat(e,"&retpath=").concat(s)}redirectToAuthorizationUrl(){}constructor(t,e){super(t,e)}}class u extends c{setPassportLoginCookieObserver(){setInterval(this.checkPassportLoginCookieChange.bind(this),5e3)}checkPassportLoginCookieChange(){this.passportLogin!==this.passportLoginCached&&(this.passportLoginCached=this.passportLogin,this.reloadPage())}reloadPage(){window.location.reload()}redirectToAuthorizationUrl(){this.authorizationUrl&&(window.location.href=this.authorizationUrl)}get passportLogin(){return this.storage.get(i.B.YandexLogin,!1)||void 0}get hasAuthorizationCredentials(){return!!this.storage.get(i.B.YandexLogin,!1)}async check(){}constructor(t,e){super(t,e),(0,n._)(this,"passportLoginCached",void 0),this.passportLoginCached=this.passportLogin,this.setPassportLoginCookieObserver()}}r(11769),(s=o||(o={})).VALID="VALID",s.NEED_RESET="NEED_RESET",s.EXPIRED="EXPIRED",s.NOAUTH="NOAUTH",s.DISABLED="DISABLED",s.INVALID="INVALID",s.WRONG_GUARD="WRONG_GUARD";var d=r(47270);class l extends h{check(){if(this.dataIsLoaded){if(!this.passportLogin&&this.token){this.removeToken(),this.reloadPage();return}if(!this.token&&this.passportLogin||this.passportLogin&&this.tokenOwnerLogin&&this.passportLogin!==this.tokenOwnerLogin){this.redirectToAuthorizationUrl();return}}}get authorizationUrl(){let{oauthCredentials:{host:t,clientId:e}}=this.config,r="".concat(this.pathname).concat(this.searchParams?"?".concat(this.searchParams):"");"/"===r.charAt(0)&&(r=r.substring(1));let s=window.location.origin,o="".concat(s,"/oauth?redirectUri=").concat(encodeURIComponent(r)),n=(0,a.v)(t,"ru"),i=new URL("".concat(n,"/authorize"));return i.searchParams.append("response_type","token"),i.searchParams.append("display","popup"),i.searchParams.append("scope","music:content"),i.searchParams.append("scope","music:read"),i.searchParams.append("scope","music:write"),i.searchParams.append("client_id",e),i.searchParams.append("redirect_uri",o),i.searchParams.append("state",this.oauthState),i.toString()}reloadPage(){window.location.reload()}redirectToAuthorizationUrl(){this.authorizationUrl&&(window.location.href=this.authorizationUrl)}setTokenOwnerLogin(t){this.tokenOwnerLogin=t}setDataIsLoaded(){this.dataIsLoaded=!0}setToken(t){t.state===this.oauthState&&this.storage.set(i.B.Oauth,t.token,{expires:Math.floor(t.expiresIn/86400)})}get token(){if(this.passportLogin)return this.storage.get(i.B.Oauth)||void 0}removeToken(){this.storage.remove(i.B.Oauth)}updateOauthState(){let t=Math.round(1e11*Math.random()).toString(16);this.storage.set(i.B.OauthState,t,{expires:1})}get oauthState(){return this.storage.get(i.B.OauthState)||""}constructor(t,e){super(t,e),(0,n._)(this,"dataIsLoaded",!1),(0,n._)(this,"tokenOwnerLogin",void 0),this.oauthState||this.updateOauthState(),this.check()}}class p extends l{get token(){return this.storage.get(i.B.Oauth)||void 0}get hasAuthorizationCredentials(){return!!this.storage.get(i.B.Oauth)}loadPassportLogin(){window.desktopEvents&&window.desktopEvents.invoke(d.B.GET_PASSPORT_LOGIN).then(t=>{this.passportLoginFromElectron=t,this.setDataIsLoaded(),this.check()})}get passportLogin(){return this.passportLoginFromElectron}constructor(t,e){super(t,e),(0,n._)(this,"passportLoginFromElectron",void 0),this.loadPassportLogin()}}},31450:function(t,e,r){"use strict";async function s(t){let{config:e}=await r(78276)("./".concat(t,".ts"));return e()}r.d(e,{i:function(){return s}})},93991:function(t,e,r){"use strict";r.d(e,{y:function(){return o}});var s=r(38060);let o=t=>{switch(t){case"win32":return s.B.WINDOWS;case"darwin":return s.B.MACOS;case"linux":return s.B.LINUX}return null}},38060:function(t,e,r){"use strict";var s,o;r.d(e,{B:function(){return s}}),(o=s||(s={})).WINDOWS="Windows",o.MACOS="MacOS",o.LINUX="Linux"},87249:function(t,e,r){"use strict";r.d(e,{s:function(){return a}});var s=r(83993);class o extends s.y{name="ContainerException";constructor(t="Internal error",{code:e="E_CONTAINER",...r}={}){super(t,{code:e,...r}),Object.setPrototypeOf(this,o.prototype)}}class n extends o{name="NotFoundContainerException";constructor(t){super(`No entry with the name '${t.toString()}' was found in the container`,{code:"E_CONTAINER_NOT_FOUND"}),Object.setPrototypeOf(this,n.prototype)}}class i extends o{name="AlreadyExistsContainerException";constructor(t){super(`A binding with the name '${t.toString()}' already exists in the container`,{code:"E_CONTAINER_ALREADY_EXISTS"}),Object.setPrototypeOf(this,i.prototype)}}class a{bindings={};shared=new Map;register(t,e){if(this.has(t))throw new i(t);return this.bindings={...this.bindings,[t]:e},this}registerMany(t){for(let e in t)if(this.has(e))throw new i(e);return this.bindings={...this.bindings,...t},this}get(t){if(this.shared.has(t))return this.shared.get(t);let e=this.bindings[t];if(void 0===e)throw new n(t);let r=this.create(e);return e.isShared&&this.shared.set(t,r),r}has(t){return t in this.bindings}create(t){return t.creator(this)}}},13362:function(t,e,r){"use strict";function s(t){return{type:"singleton",creator:t,isShared:!0}}function o(t){return{type:"factory",creator:t,isShared:!1}}r.d(e,{d5:function(){return o},ri:function(){return s}})},9052:function(t,e,r){"use strict";r.d(e,{w:function(){return g}});var s=r(16272),o=r(31455),n=r(59274),i=r(81643);let a=t=>Object.keys(t.statusCodes).filter(t=>!isNaN(Number(t))).map(t=>parseInt(t,10)),h=t=>t?.code==="ETIMEDOUT"?"TIMEOUT":t.response&&(t.response.status||t.response.statusCode)||"NON_HTTP_ERROR",c={retryLimit:0,retryDelay:0},u=({retryAttempt:t,error:e,isNotIdempotent:r,retryAfter:s,retryPolicyConfig:o})=>{if(!o||r)return c;if(s)return o.totalRequestsLimit>t?{retryLimit:o.totalRequestsLimit,retryDelay:s}:c;if(o.statusCodes[e]){let r=o.statusCodes[e];if(r?.attempts?.length&&r.attempts.length>=t)return{retryLimit:r.attempts.length+1,retryDelay:r.attempts[t-1]||1}}return c},d=async t=>new Promise(e=>setTimeout(e,t)),l=async({options:t,error:e,retryAttempt:r,clientRetryConfig:s})=>{if(e?.response?.headers?.get("Retry-After"))return;let o=h(e),n=u({error:o,retryAttempt:r,retryPolicyConfig:s?.config,isNotIdempotent:s?.isNotIdempotent});t.retry.limit=n.retryLimit,await d(n.retryDelay)},p=["GET","POST","PUT","PATCH","DELETE","HEAD","get","post","put","patch","delete","head"];class g{client;constructor(t={}){this.client=s.ZP.create(this.optionsConverter(t))}async get(t,e={}){return this.request(t,{...e,method:"GET"})}async post(t,e={}){return this.request(t,{...e,method:"POST"})}async put(t,e={}){return this.request(t,{...e,method:"PUT"})}async patch(t,e={}){return this.request(t,{...e,method:"PATCH"})}async delete(t,e={}){return this.request(t,{...e,method:"DELETE"})}async head(t,e={}){return this.request(t,{...e,method:"HEAD"})}async request(t,e){try{let r=Date.now(),s=await this.client(t,this.optionsConverter(e)),o=Date.now()-r;return this.responseConverter(s,e,{start:r,response:o})}catch(t){if(t instanceof o.B)throw this.errorConverter(t);throw t}}optionsConverter(t){let{prefixUrl:e,method:r,searchParams:s,headers:o,json:n,hooks:i,retry:h,timeout:c,credentials:u}=t,d={};if(void 0!==u&&(d.credentials=u),void 0!==e&&(d.prefixUrl=e),void 0!==r&&(d.method=r),void 0!==o&&(d.headers={...o,"user-agent":o["user-agent"]??o["User-Agent"]}),void 0!==s&&(d.searchParams=s),void 0!==n&&(d.json=n),"number"==typeof c&&(d.timeout=c),h?.config&&(d.retry={limit:h.config.totalRequestsLimit,backoffLimit:1,statusCodes:a(h.config)},d.timeout=h?.config.timeout,d.hooks=d.hooks||{},d.hooks.beforeRetry=d.hooks.beforeRetry||[],d.hooks.beforeRetry.push(async t=>{await l({request:t.request,options:t.options,error:t.error,retryAttempt:t.retryCount,clientRetryConfig:h})})),i){let t;let{beforeRequest:e,beforeRetry:r,beforeError:s,afterResponse:o}=i;void 0===d.hooks&&(d.hooks={}),Array.isArray(e)&&(d.hooks.beforeRequest=e.map(e=>async(r,s)=>{t=Date.now();let o=this.normalizeOptions(r,s);await e(o)})),Array.isArray(r)&&(d.hooks.beforeRetry=d.hooks.beforeRetry||[],d.hooks.beforeRetry=d.hooks.beforeRetry.concat(r.map(t=>async({error:e,retryCount:r})=>{await t(this.errorConverter(e),r)}))),Array.isArray(s)&&(d.hooks.beforeError=s.map(t=>async e=>(await t(this.errorConverter(e)),e))),Array.isArray(o)&&(d.hooks.afterResponse=o.map(e=>async(r,s,o)=>{let n=this.normalizeOptions(r,s),i=Date.now();return await e(this.responseConverter(o,n,{start:t,response:i})),o}))}return d}responseConverter(t,e,r){return{headers:Object.fromEntries(t.headers.entries()),statusCode:t.status,statusMessage:t.statusText,url:t.url,json:t.json.bind(t),text:t.text.bind(t),timings:r,request:{prefixUrl:e.prefixUrl,headers:e.headers,searchParams:e.searchParams,method:e.method}}}normalizeOptions(t,e){let r=new URL(t.url);return{headers:this.normalizeHeaders(e.headers),searchParams:new URLSearchParams(r.search),json:t.json,url:t.url,method:this.convertMethod(e.method),timeout:void 0}}normalizeHeaders(t){return void 0===t?{}:t instanceof Headers?Object.fromEntries(t.entries()):Array.isArray(t)?Object.fromEntries(t):t}errorConverter(t){return t instanceof o.B?new i.d(t.message,{statusCode:t.response.status,cause:t}):new n.e(t.message,{cause:t})}convertMethod(t){return void 0!==t&&p.includes(t)?t.toUpperCase():"GET"}convertMethods(t){let e=new Set;return t.forEach(t=>{p.includes(t)&&e.add(t.toUpperCase())}),[...e]}}},81643:function(t,e,r){"use strict";r.d(e,{d:function(){return o}});var s=r(59274);class o extends s.e{statusCode;constructor(t,e){super(t,{code:"E_HTTP_CLIENT_NON_2XX_3XX_RESPONSE",cause:e.cause}),this.statusCode=e.statusCode,Object.setPrototypeOf(this,o.prototype)}}},59274:function(t,e,r){"use strict";r.d(e,{e:function(){return o}});var s=r(83993);class o extends s.y{name="HttpException";constructor(t="Http Client error",{code:e="E_HTTP_CLIENT",...r}={}){super(t,{code:e,...r}),Object.setPrototypeOf(this,o.prototype)}}},49833:function(t,e,r){"use strict";r.d(e,{P:function(){return h}});var s=r(56406),o=r(58616),n=r(2208),i=r(1540);let a=()=>"SECRET";class h{maxLogLevel;secureFields;constructor({maxLogLevel:t,secureFields:e}){this.maxLogLevel=t,this.secureFields=e}formatMessage(t,e,r={},n){let i;let a=String(e instanceof Error&&e.stack?e.stack:e),h=(0,o.Z)(r);return(Object.keys(h).length&&(i=this.obfuscateData(h)),n)?`${a} ${s(i)}`:[a,i]}obfuscateData(t){if(this.secureFields?.length)for(let e of this.secureFields){let r=(0,n.Z)(t,e);void 0!==r&&(0,i.Z)(t,e,a())}return t}}},13427:function(t,e,r){"use strict";r.d(e,{j:function(){return n}});var s=r(32390),o=r(49833);class n extends o.P{constructor(t){super(t)}info(t,e){this.maxLogLevel>=s.B.INFO&&this.logToConsole(s.B.INFO,t,e)}debug(t,e){this.maxLogLevel>=s.B.DEBUG&&this.logToConsole(s.B.DEBUG,t,e)}trace(t,e){this.maxLogLevel>=s.B.TRACE&&this.logToConsole(s.B.TRACE,t,e)}warn(t,e){this.maxLogLevel>=s.B.WARNING&&this.logToConsole(s.B.WARNING,t,e),this.sendToErrorBooster(s.B.WARNING,t,e)}error(t,e){this.maxLogLevel>=s.B.ERROR&&this.logToConsole(s.B.ERROR,t,e),this.sendToErrorBooster(s.B.ERROR,t,e)}log(t,e){this.logToConsole(s.B.INFO,t,e)}logToConsole(t,e,r){let o=s.v[t];console[o](...this.formatMessage(t,e,r))}sendToErrorBooster(t,e,r){window.Ya.Rum.logError({message:e,level:t,additional:{data:r}})}}},69764:function(t,e,r){"use strict";r.d(e,{B$:function(){return s.B}});var s=r(32390);r(49833)},32390:function(t,e,r){"use strict";var s,o;r.d(e,{B:function(){return s},v:function(){return n}}),(o=s||(s={}))[o.ERROR=10]="ERROR",o[o.WARNING=20]="WARNING",o[o.INFO=30]="INFO",o[o.DEBUG=40]="DEBUG",o[o.TRACE=50]="TRACE";let n={[s.ERROR]:"error",[s.WARNING]:"warn",[s.INFO]:"info",[s.DEBUG]:"debug",[s.TRACE]:"trace"}},89788:function(t,e,r){"use strict";r.d(e,{NS:function(){return n},JC:function(){return a},$V:function(){return d},tg:function(){return u}}),r(94739);var s=r(26424);function o(t){if(!t)return null;try{return JSON.parse(t)}catch(t){return console.error(t),null}}class n{get(t,e=!0){let r=(0,s.U2)(t);return e?o(r)?.value??null:r||null}set(t,e,r,o=!0){try{let n=o?JSON.stringify({value:e}):e;(0,s.t8)(t,n,r)}catch(t){console.error(t)}}has(t){return!!this.get(t)}remove(t){(0,s.Od)(t)}}let i=t=>864e5*t;class a{get(t){if("undefined"!=typeof window){let e=window.localStorage.getItem(t)||void 0,r=o(e);if(!r)return null;let s=r?.value??null;return r?.expires&&Date.now()>new Date(r.expires).getTime()?(this.remove(t),null):s}return null}set(t,e,r){if("number"==typeof r?.expires){let t=new Date;t.setMilliseconds(t.getMilliseconds()+i(r.expires)),r.expires=t}"undefined"!=typeof window&&window.localStorage.setItem(t,JSON.stringify({value:e,...r}))}has(t){return!!this.get(t)}remove(t){"undefined"!=typeof window&&window.localStorage.removeItem(t)}}var h=r(83993);class c extends h.y{name="Storage Exception";constructor(t,e,{code:r="E_STORAGE",...s}={}){super(`There is no ${e} storage on the ${t} platform`,{code:r,...s}),Object.setPrototypeOf(this,c.prototype)}}class u{platform="";type="";constructor(t,e){this.platform=t,this.type=e}get(t){throw new c(this.platform,this.type)}set(t,e,r){throw new c(this.platform,this.type)}has(t){throw new c(this.platform,this.type)}remove(t){throw new c(this.platform,this.type)}}class d{get(t){let e=window.sessionStorage.getItem(t)??void 0;return o(e)?.value??null}set(t,e){window.sessionStorage.setItem(t,JSON.stringify({value:e}))}has(t){return!!this.get(t)}remove(t){window.sessionStorage.removeItem(t)}}}}]);
//# sourceMappingURL=7006.c16da0b08d01c9e7.js.map